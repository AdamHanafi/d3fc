{"version":3,"file":"d3-financial-components.min.js","sources":["..\\components\\sl.js","..\\components\\utilities\\weekday.js","..\\components\\indicators\\bollingerBands.js","..\\components\\indicators\\movingAverage.js","..\\components\\indicators\\relativeStrengthIndex.js","..\\components\\scale\\financeScale.js","..\\components\\scale\\gridlines.js","..\\components\\series\\candlestick.js","..\\components\\series\\comparison.js","..\\components\\series\\ohlc.js","..\\components\\series\\volume.js","..\\components\\tools\\annotation.js","..\\components\\tools\\crosshairs.js","..\\components\\tools\\fibonacciFan.js","..\\components\\tools\\measure.js","..\\components\\utilities\\dataGenerator.js","..\\components\\utilities\\dimensions.js"],"names":[],"mappings":"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","sourcesContent":["sl = {\r\n    version: '0.0.0',\r\n    indicators: {},\r\n    scale: {},\r\n    series: {},\r\n    tools: {},\r\n    utilities: {}\r\n};","(function(d3, sl) {\r\n\r\n    var weekdayCache = {};\r\n    var dateCache = {};\r\n\r\n    // Returns the weekday number for the given date relative to January 1, 1970.\r\n    function weekday(date) {\r\n        if (date in weekdayCache) {\r\n            return weekdayCache[date];\r\n        }\r\n        var weekdays = weekdayOfYear(date),\r\n            year = date.getFullYear();\r\n        while (--year >= 1970) weekdays += weekdaysInYear(year);\r\n\r\n        weekdayCache[date] = weekdays;\r\n        return weekdays;\r\n    }\r\n\r\n    // Returns the date for the specified weekday number relative to January 1, 1970.\r\n    weekday.invert = function(weekdays) {\r\n        if (weekdays in dateCache) {\r\n            return dateCache[weekdays];\r\n        }\r\n        var year = 1970,\r\n            yearWeekdays,\r\n            result;\r\n\r\n        // Compute the year.\r\n        while ((yearWeekdays = weekdaysInYear(year)) <= weekdays) {\r\n            ++year;\r\n            weekdays -= yearWeekdays;\r\n        }\r\n\r\n        // Compute the date from the remaining weekdays.\r\n        var days = weekdays % 5,\r\n            day0 = ((new Date(year, 0, 1)).getDay() + 6) % 7;\r\n        if (day0 + days > 4) days += 2;\r\n\r\n        result = new Date(year, 0, (weekdays / 5 | 0) * 7 + days + 1);\r\n        dateCache[weekdays] = result;\r\n        return result;\r\n    };\r\n\r\n    // Returns the number of weekdays in the specified year.\r\n    function weekdaysInYear(year) {\r\n        return weekdayOfYear(new Date(year, 11, 31)) + 1;\r\n    }\r\n\r\n    // Returns the weekday number for the given date relative to the start of the year.\r\n    function weekdayOfYear(date) {\r\n        var days = d3.time.dayOfYear(date),\r\n            weeks = days / 7 | 0,\r\n            day0 = (d3.time.year(date).getDay() + 6) % 7,\r\n            day1 = day0 + days - weeks * 7;\r\n        return Math.max(0, days - weeks * 2\r\n            - (day0 <= 5 && day1 >= 5 || day0 <= 12 && day1 >= 12) // extra saturday\r\n            - (day0 <= 6 && day1 >= 6 || day0 <= 13 && day1 >= 13)); // extra sunday\r\n    }\r\n\r\n    sl.utilities.weekday = weekday;\r\n\r\n}(d3, sl));\r\n","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    sl.indicators.bollingerBands = function () {\r\n\r\n        var xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear();\r\n\r\n        var yValue = 0,\r\n            movingAverage = 20,\r\n            standardDeviations = 2;\r\n\r\n        var cssBandArea = 'bollingerBandArea',\r\n            cssBandUpper = 'bollingerBandUpper',\r\n            cssBandLower = 'bollingerBandLower',\r\n            cssAverage = 'bollingerAverage';\r\n\r\n        var bollingerBands = function (selection) {\r\n\r\n            var areaBands = d3.svg.area(),\r\n                lineUpper = d3.svg.line(),\r\n                lineLower = d3.svg.line(),\r\n                lineAverage = d3.svg.line();\r\n\r\n            areaBands.x(function (d) { return xScale(d.date); });\r\n            lineUpper.x(function (d) { return xScale(d.date); });\r\n            lineLower.x(function (d) { return xScale(d.date); });\r\n            lineAverage.x(function (d) { return xScale(d.date); });\r\n\r\n            var calculateMovingAverage = function (data, i) {\r\n\r\n                if (movingAverage === 0) {\r\n                    return data[i][yValue];\r\n                }\r\n\r\n                var count = Math.min(movingAverage, i + 1),\r\n                    first = i + 1 - count;\r\n\r\n                var sum = 0;\r\n                for (var index = first; index <= i; ++index) {\r\n                    var x = data[index][yValue];\r\n                    sum += x;\r\n                }\r\n\r\n                return sum / count;\r\n            };\r\n\r\n            var calculateMovingStandardDeviation = function (data, i, avg) {\r\n\r\n                if (movingAverage === 0) {\r\n                    return 0;\r\n                }\r\n\r\n                var count = Math.min(movingAverage, i + 1),\r\n                    first = i + 1 - count;\r\n\r\n                var sum = 0;\r\n                for (var index = first; index <= i; ++index) {\r\n                    var x = data[index][yValue];\r\n                    var dx = x - avg;\r\n                    sum += (dx * dx);\r\n                }\r\n\r\n                var variance = sum / count;\r\n                return Math.sqrt(variance);\r\n            };\r\n\r\n            selection.each(function (data) {\r\n\r\n                var bollingerData = {};\r\n                for (var index = 0; index < data.length; ++index) {\r\n\r\n                    var date = data[index].date;\r\n\r\n                    var avg = calculateMovingAverage(data, index);\r\n                    var sd = calculateMovingStandardDeviation(data, index, avg);\r\n\r\n                    bollingerData[date] = {avg: avg, sd: sd};\r\n                }\r\n\r\n                areaBands.y0(function (d) {\r\n\r\n                    var avg = bollingerData[d.date].avg;\r\n                    var sd = bollingerData[d.date].sd;\r\n\r\n                    return yScale(avg + (sd * standardDeviations));\r\n                });\r\n\r\n                areaBands.y1(function (d) {\r\n\r\n                    var avg = bollingerData[d.date].avg;\r\n                    var sd = bollingerData[d.date].sd;\r\n\r\n                    return yScale(avg - (sd * standardDeviations));\r\n                });\r\n\r\n                lineUpper.y(function (d) {\r\n\r\n                    var avg = bollingerData[d.date].avg;\r\n                    var sd = bollingerData[d.date].sd;\r\n\r\n                    return yScale(avg + (sd * standardDeviations));\r\n                });\r\n\r\n                lineLower.y(function (d) {\r\n\r\n                    var avg = bollingerData[d.date].avg;\r\n                    var sd = bollingerData[d.date].sd;\r\n\r\n                    return yScale(avg - (sd * standardDeviations));\r\n                });\r\n\r\n                lineAverage.y(function (d) {\r\n\r\n                    var avg = bollingerData[d.date].avg;\r\n\r\n                    return yScale(avg);\r\n                });\r\n\r\n                var prunedData = [];\r\n                for (var index = movingAverage; index < data.length; ++index) {\r\n                    prunedData.push(data[index]);\r\n                }\r\n\r\n                var pathArea = d3.select(this).selectAll('.area')\r\n                    .data([prunedData]);\r\n                var pathUpper = d3.select(this).selectAll('.upper')\r\n                    .data([prunedData]);\r\n                var pathLower = d3.select(this).selectAll('.lower')\r\n                    .data([prunedData]);\r\n                var pathAverage = d3.select(this).selectAll('.average')\r\n                    .data([prunedData]);\r\n\r\n                pathArea.enter().append('path');\r\n                pathUpper.enter().append('path');\r\n                pathLower.enter().append('path');\r\n                pathAverage.enter().append('path');\r\n\r\n                pathArea.attr('d', areaBands)\r\n                    .classed('area', true)\r\n                    .classed(cssBandArea, true);\r\n                pathUpper.attr('d', lineUpper)\r\n                    .classed('upper', true)\r\n                    .classed(cssBandUpper, true);\r\n                pathLower.attr('d', lineLower)\r\n                    .classed('lower', true)\r\n                    .classed(cssBandLower, true);\r\n                pathAverage.attr('d', lineAverage)\r\n                    .classed('average', true)\r\n                    .classed(cssAverage, true);\r\n\r\n                pathArea.exit().remove();\r\n                pathUpper.exit().remove();\r\n                pathLower.exit().remove();\r\n                pathAverage.exit().remove();\r\n            });\r\n        };\r\n\r\n        bollingerBands.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return bollingerBands;\r\n        };\r\n\r\n        bollingerBands.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return bollingerBands;\r\n        };\r\n\r\n        bollingerBands.yValue = function (value) {\r\n            if (!arguments.length) {\r\n                return yValue;\r\n            }\r\n            yValue = value;\r\n            return bollingerBands;\r\n        };\r\n\r\n        bollingerBands.movingAverage = function (value) {\r\n            if (!arguments.length) {\r\n                return movingAverage;\r\n            }\r\n            if (value >= 0) {\r\n                movingAverage = value;\r\n            }\r\n            return bollingerBands;\r\n        };\r\n\r\n        bollingerBands.standardDeviations = function (value) {\r\n            if (!arguments.length) {\r\n                return standardDeviations;\r\n            }\r\n            if (value >= 0) {\r\n                standardDeviations = value;\r\n            }\r\n            return bollingerBands;\r\n        };\r\n\r\n        bollingerBands.cssBandUpper = function (value) {\r\n            if (!arguments.length) {\r\n                return cssBandUpper;\r\n            }\r\n            cssBandUpper = value;\r\n            return bollingerBands;\r\n        };\r\n\r\n        bollingerBands.cssBandLower = function (value) {\r\n            if (!arguments.length) {\r\n                return cssBandLower;\r\n            }\r\n            cssBandLower = value;\r\n            return bollingerBands;\r\n        };\r\n\r\n        bollingerBands.cssBandArea = function (value) {\r\n            if (!arguments.length) {\r\n                return cssBandArea;\r\n            }\r\n            cssBandArea = value;\r\n            return bollingerBands;\r\n        };\r\n\r\n        bollingerBands.cssAverage = function (value) {\r\n            if (!arguments.length) {\r\n                return cssAverage;\r\n            }\r\n            cssAverage = value;\r\n            return bollingerBands;\r\n        };\r\n\r\n        return bollingerBands;\r\n    };\r\n}(d3, sl));\r\n","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    sl.indicators.movingAverage = function () {\r\n\r\n        var xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear(),\r\n            yValue = 0,\r\n            yLabel = '',\r\n            averagePoints = 0,\r\n            css = '';\r\n\r\n        var movingAverage = function (selection) {\r\n\r\n            var line = d3.svg.line();\r\n            line.x(function (d) { return xScale(d.date); });\r\n\r\n            selection.each(function (data) {\r\n\r\n                if (!isNaN(parseFloat(yValue))) {\r\n\r\n                    line.y(yScale(yValue));\r\n                }\r\n                else {\r\n\r\n                    if (averagePoints === 0) {\r\n                        \r\n                        line.y(function (d) { return yScale(d[yValue]); });\r\n                    }\r\n                    else {\r\n\r\n                        line.y(function (d, i) {\r\n\r\n                                var count = Math.min(averagePoints, i + 1),\r\n                                    first = i + 1 - count;\r\n\r\n                                var sum = 0;\r\n                                for (var index = first; index <= i; ++index) {\r\n                                    sum += data[index][yValue];\r\n                                }\r\n                                var mean = sum / count;\r\n\r\n                                return yScale(mean);\r\n                            });\r\n                    }\r\n                }\r\n\r\n                var path = d3.select(this).selectAll('.indicator')\r\n                    .data([data]);\r\n\r\n                path.enter().append('path');\r\n\r\n                path.attr('d', line)\r\n                    .classed('indicator', true)\r\n                    .classed(css, true);\r\n\r\n                path.exit().remove();\r\n            });\r\n        };\r\n\r\n        movingAverage.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return movingAverage;\r\n        };\r\n\r\n        movingAverage.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return movingAverage;\r\n        };\r\n\r\n        movingAverage.yValue = function (value) {\r\n            if (!arguments.length) {\r\n                return yValue;\r\n            }\r\n            yValue = value;\r\n            return movingAverage;\r\n        };\r\n\r\n        movingAverage.yLabel = function (value) {\r\n            if (!arguments.length) {\r\n                return yLabel;\r\n            }\r\n            yLabel = value;\r\n            return movingAverage;\r\n        };\r\n\r\n        movingAverage.averagePoints = function (value) {\r\n            if (!arguments.length) {\r\n                return averagePoints;\r\n            }\r\n            if (value >= 0) {\r\n                averagePoints = value;\r\n            }\r\n            return movingAverage;\r\n        };\r\n\r\n        movingAverage.css = function (value) {\r\n            if (!arguments.length) {\r\n                return css;\r\n            }\r\n            css = value;\r\n            return movingAverage;\r\n        };\r\n\r\n        return movingAverage;\r\n    };\r\n}(d3, sl));\r\n","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    sl.indicators.rsi = function () {\r\n\r\n        var xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear(),\r\n            samplePeriods = 0,\r\n            upperMarker = 70,\r\n            lowerMarker = 30,\r\n            lambda = 1.0,\r\n            css = '';\r\n\r\n        var upper = null,\r\n            centre = null,\r\n            lower = null;\r\n\r\n        var rsi = function (selection) {\r\n\r\n            upper = selection.append('line')\r\n                .attr('class', 'marker upper')\r\n                .attr('x1', xScale.range()[0]) \r\n                .attr('y1', yScale(upperMarker))\r\n                .attr('x2', xScale.range()[1]) \r\n                .attr('y2', yScale(upperMarker));\r\n\r\n            centre = selection.append('line')\r\n                .attr('class', 'marker centre')\r\n                .attr('x1', xScale.range()[0]) \r\n                .attr('y1', yScale(50))\r\n                .attr('x2', xScale.range()[1]) \r\n                .attr('y2', yScale(50));\r\n\r\n            lower = selection.append('line')\r\n                .attr('class', 'marker lower')\r\n                .attr('x1', xScale.range()[0]) \r\n                .attr('y1', yScale(lowerMarker))\r\n                .attr('x2', xScale.range()[1]) \r\n                .attr('y2', yScale(lowerMarker));\r\n\r\n            var line = d3.svg.line();\r\n            line.x(function (d) { return xScale(d.date); });\r\n\r\n            selection.each(function (data) {\r\n\r\n                if (samplePeriods === 0) {\r\n                    line.y(function (d) { return yScale(0); });\r\n                }\r\n                else {\r\n                    line.y(function (d, i) {\r\n                        var from = i - samplePeriods,\r\n                            to = i,\r\n                            up = [],\r\n                            down = [];\r\n\r\n                        if(from < 1) from = 1;\r\n\r\n                        for( var offset = to; offset >= from; offset--) {\r\n                            var dnow = data[offset],\r\n                                dprev = data[offset-1];\r\n\r\n                            var weight = Math.pow(lambda, offset);\r\n                            up.push(dnow.close > dprev.close ? (dnow.close - dprev.close) * weight : 0);\r\n                            down.push(dnow.close < dprev.close ? (dprev.close - dnow.close) * weight : 0);\r\n                        }\r\n\r\n                        if(up.length <= 0 || down.length <= 0) return yScale(0);\r\n\r\n                        var rsi = 100 - (100/(1+(d3.mean(up)/d3.mean(down))));\r\n                        return yScale(rsi);\r\n                    });\r\n                }\r\n\r\n                var path = d3.select(this).selectAll('.rsi')\r\n                    .data([data]);\r\n\r\n                path.enter().append('path');\r\n\r\n                path.attr('d', line)\r\n                    .classed('rsi', true)\r\n                    .classed(css, true);\r\n\r\n                path.exit().remove();\r\n            });\r\n        };\r\n\r\n        rsi.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return rsi;\r\n        };\r\n\r\n        rsi.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return rsi;\r\n        };\r\n\r\n        rsi.samplePeriods = function (value) {\r\n            if (!arguments.length) {\r\n                return samplePeriods;\r\n            }\r\n            samplePeriods = value < 0 ? 0 : value;\r\n            return rsi;\r\n        };\r\n\r\n        rsi.upperMarker = function (value) {\r\n            if (!arguments.length) {\r\n                return upperMarker;\r\n            }\r\n            upperMarker = value > 100 ? 100 : (value < 0 ? 0 : value);\r\n            return rsi;\r\n        };\r\n\r\n        rsi.lowerMarker = function (value) {\r\n            if (!arguments.length) {\r\n                return lowerMarker;\r\n            }\r\n            lowerMarker = value > 100 ? 100 : (value < 0 ? 0 : value);\r\n            return rsi;\r\n        };\r\n\r\n        rsi.lambda = function (value) {\r\n            if (!arguments.length) {\r\n                return lambda;\r\n            }\r\n            lambda = value > 1.0 ? 1.0 : (value < 0.0 ? 0.0 : value);\r\n            return rsi;\r\n        };\r\n\r\n        rsi.css = function (value) {\r\n            if (!arguments.length) {\r\n                return css;\r\n            }\r\n            css = value;\r\n            return rsi;\r\n        };\r\n\r\n        return rsi;\r\n    };\r\n}(d3, sl));","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    var weekday = sl.utilities.weekday\r\n\r\n    sl.scale.finance = function () {\r\n        return financialScale();\r\n    };\r\n\r\n    function financialScale(linear) {\r\n\r\n        if (!arguments.length) {\r\n            linear = d3.scale.linear();\r\n        }\r\n\r\n        function scale(x) {\r\n            if (typeof x === 'number') {\r\n                // When scaling ticks.\r\n                return linear(x);\r\n            } else {\r\n                // When scaling dates.\r\n                return linear(weekday(x));\r\n            }\r\n        };\r\n\r\n        scale.copy = function () {\r\n            return financialScale(linear.copy());\r\n        };\r\n\r\n        scale.domain = function (domain) {\r\n            if (!arguments.length) {\r\n                return linear.domain().map(weekday.invert);\r\n            }\r\n            if (typeof domain[0] === 'number') {\r\n                linear.domain(domain);\r\n            } else {\r\n                linear.domain(domain.map(weekday));\r\n            }\r\n            return scale;\r\n        };\r\n\r\n        scale.ticks = function (n) {\r\n            return arguments.length ? linear.ticks(n) : linear.ticks();\r\n        };\r\n\r\n        scale.tickFormat = function (count, f) {\r\n            return function(n) {\r\n                var date = weekday.invert(n);\r\n                return d3.time.format('%b %e')(date);\r\n            };\r\n        };\r\n\r\n        scale.invert = function (pixel) {\r\n            return weekday.invert(linear.invert(pixel))\r\n        };\r\n\r\n        return d3.rebind(scale, linear, \"range\", \"rangeRound\", \"interpolate\", \"clamp\", \"nice\");\r\n    }\r\n}(d3, sl));","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    sl.scale.gridlines = function () {\r\n\r\n        var xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear(),\r\n            xTicks = 10,\r\n            yTicks = 10;\r\n\r\n        var xLines = function (data, grid) {\r\n            var xlines = grid.selectAll('.x')\r\n                .data(data);\r\n            xlines\r\n                .enter().append('line')\r\n                .attr({\r\n                    'class': 'x',\r\n                    'x1': function(d) { return xScale(d);},\r\n                    'x2': function(d) { return xScale(d);},\r\n                    'y1': yScale.range()[0],\r\n                    'y2': yScale.range()[1]\r\n                });\r\n            xlines\r\n                .attr({\r\n                    'x1': function(d) { return xScale(d);},\r\n                    'x2': function(d) { return xScale(d);},\r\n                    'y1': yScale.range()[0],\r\n                    'y2': yScale.range()[1]\r\n                });\r\n            xlines.exit().remove();\r\n        };\r\n\r\n        var yLines = function (data, grid) {\r\n            var ylines = grid.selectAll('.y')\r\n                .data(data);\r\n            ylines\r\n                .enter().append('line')\r\n                .attr({\r\n                    'class': 'y',\r\n                    'x1': xScale.range()[0],\r\n                    'x2': xScale.range()[1],\r\n                    'y1': function(d) { return yScale(d);},\r\n                    'y2': function(d) { return yScale(d);}\r\n                });\r\n            ylines\r\n                .attr({\r\n                    'x1': xScale.range()[0],\r\n                    'x2': xScale.range()[1],\r\n                    'y1': function(d) { return yScale(d);},\r\n                    'y2': function(d) { return yScale(d);}\r\n                });\r\n            ylines.exit().remove();\r\n        };\r\n\r\n        var gridlines = function (selection) {\r\n            var grid, xTickData, yTickData;\r\n\r\n            selection.each(function () {\r\n                xTickData = xScale.ticks(xTicks);\r\n                yTickData = yScale.ticks(yTicks);\r\n\r\n                grid = d3.select(this).selectAll('.gridlines').data([[xTickData, yTickData]]);\r\n                grid.enter().append('g').classed('gridlines', true);\r\n                xLines(xTickData, grid);\r\n                yLines(yTickData, grid);\r\n            });\r\n        };\r\n\r\n        gridlines.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return gridlines;\r\n        };\r\n\r\n        gridlines.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return gridlines;\r\n        };\r\n\r\n        gridlines.xTicks = function (value) {\r\n            if (!arguments.length) {\r\n                return xTicks;\r\n            }\r\n            xTicks = value;\r\n            return gridlines;\r\n        };\r\n\r\n        gridlines.yTicks = function (value) {\r\n            if (!arguments.length) {\r\n                return yTicks;\r\n            }\r\n            yTicks = value;\r\n            return gridlines;\r\n        };\r\n\r\n        return gridlines;\r\n    };\r\n}(d3, sl));\r\n","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    sl.series.candlestick = function () {\r\n\r\n        var xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear();\r\n\r\n        var rectangleWidth = 5;\r\n\r\n        var isUpDay = function(d) {\r\n            return d.close > d.open;\r\n        };\r\n        var isDownDay = function (d) {\r\n            return !isUpDay(d);\r\n        };\r\n\r\n        var line = d3.svg.line()\r\n            .x(function (d) {\r\n                return d.x;\r\n            })\r\n            .y(function (d) {\r\n                return d.y;\r\n            });\r\n\r\n        var highLowLines = function (bars) {\r\n\r\n            var paths = bars.selectAll('.high-low-line').data(function (d) {\r\n                return [d];\r\n            });\r\n\r\n            paths.enter().append('path');\r\n\r\n            paths.classed('high-low-line', true)\r\n                .attr('d', function (d) {\r\n                    return line([\r\n                        { x: xScale(d.date), y: yScale(d.high) },\r\n                        { x: xScale(d.date), y: yScale(d.low) }\r\n                    ]);\r\n                });\r\n        };\r\n\r\n        var rectangles = function (bars) {\r\n            var rect;\r\n\r\n            rect = bars.selectAll('rect').data(function (d) {\r\n                return [d];\r\n            });\r\n\r\n            rect.enter().append('rect');\r\n\r\n            rect.attr('x', function (d) {\r\n                return xScale(d.date) - rectangleWidth;\r\n            })\r\n                .attr('y', function (d) {\r\n                    return isUpDay(d) ? yScale(d.close) : yScale(d.open);\r\n                })\r\n                .attr('width', rectangleWidth * 2)\r\n                .attr('height', function (d) {\r\n                    return isUpDay(d) ?\r\n                        yScale(d.open) - yScale(d.close) :\r\n                        yScale(d.close) - yScale(d.open);\r\n                });\r\n        };\r\n\r\n        var candlestick = function (selection) {\r\n            var series, bars;\r\n\r\n            selection.each(function (data) {\r\n                series = d3.select(this).selectAll('.candlestick-series').data([data]);\r\n\r\n                series.enter().append('g')\r\n                    .classed('candlestick-series', true);\r\n\r\n                bars = series.selectAll('.bar')\r\n                    .data(data, function (d) {\r\n                        return d.date;\r\n                    });\r\n\r\n                bars.enter()\r\n                    .append('g')\r\n                    .classed('bar', true);\r\n\r\n                bars.classed({\r\n                    'up-day': isUpDay,\r\n                    'down-day': isDownDay\r\n                });\r\n\r\n                highLowLines(bars);\r\n                rectangles(bars);\r\n\r\n                bars.exit().remove();\r\n\r\n\r\n            });\r\n        };\r\n\r\n        candlestick.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return candlestick;\r\n        };\r\n\r\n        candlestick.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return candlestick;\r\n        };\r\n\r\n        candlestick.rectangleWidth = function (value) {\r\n            if (!arguments.length) {\r\n                return rectangleWidth;\r\n            }\r\n            rectangleWidth = value;\r\n            return candlestick;\r\n        };\r\n\r\n        return candlestick;\r\n\r\n    };\r\n}(d3, sl));","// TODO where is yScaleTransform?\r\n(function (d3, sl, yScaleTransform) {\r\n    'use strict';\r\n\r\n    sl.series.comparison = function () {\r\n\r\n        var xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear();\r\n\r\n        var cachedData, cachedScale;\r\n\r\n        var findIndex = function (seriesData, date) {\r\n            var bisect = d3.bisector(\r\n                function (d) {\r\n                    return d.date;\r\n                }).left;\r\n\r\n            var initialIndex = bisect(seriesData, date);\r\n            if (!initialIndex) {\r\n                initialIndex += 1;\r\n            }\r\n            return initialIndex;\r\n        };\r\n\r\n        var percentageChange = function (seriesData, initialDate) {\r\n            var initialIndex = findIndex(seriesData, initialDate) - 1;\r\n            var initialClose = seriesData[initialIndex].close;\r\n\r\n            return seriesData.map(function (d) {\r\n                return {\r\n                    date: d.date,\r\n                    change: (d.close / initialClose) - 1\r\n                };\r\n            });\r\n        };\r\n\r\n        var rebaseChange = function (seriesData, initialDate) {\r\n            var initialIndex = findIndex(seriesData, initialDate) - 1;\r\n            var initialChange = seriesData[initialIndex].change;\r\n\r\n            return seriesData.map(function (d) {\r\n                return {\r\n                    date: d.date,\r\n                    change: d.change - initialChange\r\n                };\r\n            });\r\n        };\r\n\r\n         var calculateYDomain = function (data, xDomain) {\r\n            var start, end;\r\n\r\n            data = data.map(function (series) {\r\n                series = series.data;\r\n                start = findIndex(series,xDomain[0]) - 1;\r\n                end = findIndex(series,xDomain[1]) + 1;\r\n                return series.slice(start, end);\r\n            });\r\n\r\n            var allPoints = data.reduce(function(prev, curr) {\r\n                return prev.concat(curr);\r\n            }, []);\r\n\r\n            if (allPoints.length) {\r\n                return d3.extent(allPoints, function(d) {\r\n                    return d.change;\r\n                });\r\n            } else {\r\n                return [0, 0];\r\n            }\r\n        };\r\n\r\n        var color = d3.scale.category10();\r\n\r\n        var line = d3.svg.line()\r\n            .interpolate(\"linear\")\r\n            .x(function (d) {\r\n                return xScale(d.date);\r\n            })\r\n            .y(function (d) {\r\n                return yScale(d.change);\r\n            });\r\n\r\n        var comparison = function (selection) {\r\n            var series, lines;\r\n\r\n            selection.each(function (data) {\r\n\r\n                data = data.map(function (d) {\r\n                    return {\r\n                        name: d.name,\r\n                        data: percentageChange(d.data, xScale.domain()[0])\r\n                    };\r\n                });\r\n\r\n                cachedData = data; // Save for rebasing.\r\n\r\n                color.domain(data.map(function (d) {\r\n                    return d.name;\r\n                }));\r\n\r\n                yScale.domain(calculateYDomain(data, xScale.domain()));\r\n                cachedScale = yScale.copy();\r\n\r\n                series = d3.select(this).selectAll('.comparison-series').data([data]);\r\n                series.enter().append('g').classed('comparison-series', true);\r\n\r\n                lines = series.selectAll('.line')\r\n                    .data(data, function(d) {\r\n                        return d.name;\r\n                    })\r\n                    .enter().append(\"path\")\r\n                    .attr(\"class\", \"line\")\r\n                    .attr(\"d\", function (d) {\r\n                        return line(d.data);\r\n                    })\r\n                    .style(\"stroke\", function (d) {\r\n                        return color(d.name);\r\n                    });\r\n\r\n                series.selectAll('.line')\r\n                    .attr(\"d\", function (d) {\r\n                        return line(d.data);\r\n                    });\r\n            });\r\n        };\r\n\r\n        comparison.geometricZoom = function (selection, xTransformTranslate, xTransformScale) {\r\n            // Apply a transformation for each line to update its position wrt the new initial date,\r\n            // then apply the yScale transformation to reflect the updated yScale domain.\r\n\r\n            var initialIndex,\r\n                yTransform;\r\n\r\n            var lineTransform = function (initialChange) {\r\n                var yTransformLineTranslate = cachedScale(0) - cachedScale(initialChange);\r\n\r\n                yTransformLineTranslate *= yTransform.scale;\r\n                yTransformLineTranslate += yTransform.translate;\r\n\r\n                return 'translate(' + xTransformTranslate + ',' + yTransformLineTranslate + ')' +\r\n                    ' scale(' + xTransformScale + ',' + yTransform.scale + ')';\r\n            };\r\n\r\n            var domainData = cachedData.map(function (d) {\r\n                return {\r\n                    name: d.name,\r\n                    data: rebaseChange(d.data, xScale.domain()[0])\r\n                }\r\n            });\r\n\r\n            yScale.domain(calculateYDomain(domainData, xScale.domain()));\r\n            yTransform = yScaleTransform(cachedScale, yScale);\r\n\r\n            cachedData = cachedData.map(function (d) {\r\n                initialIndex = findIndex(d.data, xScale.domain()[0]) - 1;\r\n                return {\r\n                    name: d.name,\r\n                    data: d.data,\r\n                    transform: lineTransform(d.data[initialIndex].change)\r\n                };\r\n            });\r\n\r\n            selection.selectAll('.line')\r\n                .data(cachedData)\r\n                .attr('transform', function (d) { return d.transform; });\r\n        };\r\n\r\n        comparison.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return comparison;\r\n        };\r\n\r\n        comparison.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return comparison;\r\n        };\r\n\r\n        return comparison;\r\n    };\r\n}(d3, sl));","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    sl.series.ohlc = function () {\r\n\r\n        var xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear();\r\n\r\n        var isUpDay = function(d) {\r\n            return d.close > d.open;\r\n        };\r\n        var isDownDay = function (d) {\r\n            return !isUpDay(d);\r\n        };\r\n\r\n        var tickWidth = 5;\r\n\r\n        var line = d3.svg.line()\r\n            .x(function (d) {\r\n                return d.x;\r\n            })\r\n            .y(function (d) {\r\n                return d.y;\r\n            });\r\n\r\n        var highLowLines = function (bars) {\r\n\r\n            var paths = bars.selectAll('.high-low-line').data(function (d) {\r\n                return [d];\r\n            });\r\n\r\n            paths.enter().append('path');\r\n\r\n            paths.classed('high-low-line', true)\r\n                .attr('d', function (d) {\r\n                    return line([\r\n                        { x: xScale(d.date), y: yScale(d.high) },\r\n                        { x: xScale(d.date), y: yScale(d.low) }\r\n                    ]);\r\n                });\r\n        };\r\n\r\n        var openCloseTicks = function (bars) {\r\n            var open,\r\n                close;\r\n\r\n            open = bars.selectAll('.open-tick').data(function (d) {\r\n                return [d];\r\n            });\r\n\r\n            close = bars.selectAll('.close-tick').data(function (d) {\r\n                return [d];\r\n            });\r\n\r\n            open.enter().append('path');\r\n            close.enter().append('path');\r\n\r\n            open.classed('open-tick', true)\r\n                .attr('d', function (d) {\r\n                    return line([\r\n                        { x: xScale(d.date) - tickWidth, y: yScale(d.open) },\r\n                        { x: xScale(d.date), y: yScale(d.open) }\r\n                    ]);\r\n                });\r\n\r\n            close.classed('close-tick', true)\r\n                .attr('d', function (d) {\r\n                    return line([\r\n                        { x: xScale(d.date), y: yScale(d.close) },\r\n                        { x: xScale(d.date) + tickWidth, y: yScale(d.close) }\r\n                    ]);\r\n                });\r\n\r\n            open.exit().remove();\r\n            close.exit().remove();\r\n        };\r\n\r\n        var ohlc = function (selection) {\r\n            var series, bars;\r\n\r\n            selection.each(function (data) {\r\n                // series = d3.select(this);\r\n\r\n                series = d3.select(this).selectAll('.ohlc-series').data([data]);\r\n                series.enter().append('g').classed('ohlc-series', true);\r\n\r\n                bars = series.selectAll('.bar')\r\n                    .data(data, function (d) {\r\n                        return d.date;\r\n                    });\r\n\r\n                bars.enter()\r\n                    .append('g')\r\n                    .classed('bar', true);\r\n\r\n                bars.classed({\r\n                    'up-day': isUpDay,\r\n                    'down-day': isDownDay\r\n                });\r\n                highLowLines(bars);\r\n                openCloseTicks(bars);\r\n\r\n                bars.exit().remove();\r\n\r\n\r\n            });\r\n        };\r\n\r\n        ohlc.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return ohlc;\r\n        };\r\n\r\n        ohlc.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return ohlc;\r\n        };\r\n\r\n        ohlc.tickWidth = function (value) {\r\n            if (!arguments.length) {\r\n                return tickWidth;\r\n            }\r\n            tickWidth = value;\r\n            return ohlc;\r\n        };\r\n\r\n        return ohlc;\r\n\r\n    };\r\n}(d3, sl));","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    sl.series.volume = function () {\r\n\r\n        var xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear();\r\n\r\n        var barWidth = 5;\r\n\r\n        var isUpDay = function(d) {\r\n            return d.close > d.open;\r\n        };\r\n        var isDownDay = function (d) {\r\n            return !isUpDay(d);\r\n        };\r\n\r\n        var rectangles = function (bars) {\r\n            var rect;\r\n\r\n            rect = bars.selectAll('rect').data(function (d) {\r\n                return [d];\r\n            });\r\n\r\n            rect.enter().append('rect');\r\n\r\n            rect.attr('x', function (d) { return xScale(d.date) - barWidth; })\r\n                .attr('y', function(d) { return yScale(d.volume); } )\r\n                .attr('width', barWidth * 2)\r\n                .attr('height', function(d) { return yScale(0) - yScale(d.volume); });\r\n        };\r\n\r\n        var volume = function (selection) {\r\n            var series, bars;\r\n\r\n            selection.each(function (data) {\r\n                series = d3.select(this).selectAll('.volume-series').data([data]);\r\n\r\n                series.enter().append('g')\r\n                    .classed('volume-series', true);\r\n\r\n                bars = series.selectAll('.volumebar')\r\n                    .data(data, function (d) {\r\n                        return d.date;\r\n                    });\r\n\r\n                bars.enter()\r\n                    .append('g')\r\n                    .classed('volumebar', true);\r\n\r\n                bars.classed({\r\n                    'up-day': isUpDay,\r\n                    'down-day': isDownDay\r\n                });\r\n                rectangles(bars);\r\n                bars.exit().remove();\r\n           });\r\n        };\r\n\r\n        volume.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return volume;\r\n        };\r\n\r\n        volume.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return volume;\r\n        };\r\n\r\n        volume.barWidth = function (value) {\r\n            if (!arguments.length) {\r\n                return barWidth;\r\n            }\r\n            barWidth = value;\r\n            return volume;\r\n        };\r\n\r\n        return volume;\r\n    };\r\n}(d3, sl));","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    sl.tools.annotation = function () {\r\n\r\n        var index = 0,\r\n            xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear(),\r\n            yLabel = '',\r\n            yValue = 0,\r\n            padding = 2,\r\n            formatCallout = function(d) { return d; };\r\n\r\n        var root = null,\r\n            line = null,\r\n            callout = null;\r\n\r\n        var annotation = function (selection) {\r\n\r\n            root = selection.append('g')\r\n                .attr('id', 'annotation_' + index)\r\n                .attr('class', 'annotation');\r\n\r\n            line = root.append(\"line\")\r\n                .attr('class', 'marker')\r\n                .attr('x1', xScale.range()[0]) \r\n                .attr('y1', yScale(yValue))\r\n                .attr('x2', xScale.range()[1]) \r\n                .attr('y2', yScale(yValue));\r\n\r\n\r\n            callout = root.append(\"text\")\r\n                .attr('class', 'callout')\r\n                .attr('x', xScale.range()[1] - padding)\r\n                .attr('y', yScale(yValue) - padding)\r\n                .attr('style', 'text-anchor: end;')\r\n                .text(yLabel + \" : \" + formatCallout(yValue));\r\n        };\r\n\r\n        annotation.index = function (value) {\r\n            if (!arguments.length) {\r\n                return index;\r\n            }\r\n            index = value;\r\n            return annotation;\r\n        };\r\n\r\n        annotation.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return annotation;\r\n        };\r\n\r\n        annotation.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return annotation;\r\n        };\r\n\r\n        annotation.yValue = function (value) {\r\n            if (!arguments.length) {\r\n                return yValue;\r\n            }\r\n            yValue = value;\r\n            return annotation;\r\n        };\r\n\r\n        annotation.yLabel = function (value) {\r\n            if (!arguments.length) {\r\n                return yLabel;\r\n            }\r\n            yLabel = value;\r\n            return annotation;\r\n        };\r\n\r\n        annotation.padding = function (value) {\r\n            if (!arguments.length) {\r\n                return padding;\r\n            }\r\n            padding = value;\r\n            return annotation;\r\n        };\r\n\r\n        annotation.formatCallout = function (value) {\r\n            if (!arguments.length) {\r\n                return formatCallout;\r\n            }\r\n            formatCallout = value;\r\n            return annotation;\r\n        };\r\n\r\n        return annotation;\r\n    };\r\n}(d3, sl));","(function (d3, sl) {\r\n    'use strict';\r\n\r\nsl.tools.crosshairs = function () {\r\n\r\n    var target = null,\r\n        series = null,\r\n        xScale = d3.time.scale(),\r\n        yScale = d3.scale.linear(),\r\n        yValue = null,\r\n        formatH = null,\r\n        formatV = null,\r\n        active = true,\r\n        freezable = true,\r\n        padding = 2;\r\n\r\n    var lineH = null,\r\n        lineV = null,\r\n        circle = null,\r\n        calloutH = null,\r\n        calloutV = null;\r\n\r\n    var highlight = null,\r\n        highlightedField = null;\r\n\r\n    var crosshairs = function () {\r\n\r\n        var root = target.append('g')\r\n            .attr('class', 'crosshairs');\r\n\r\n        lineH = root.append(\"line\")\r\n            .attr('class', 'crosshairs horizontal')\r\n            .attr('x1', xScale.range()[0])\r\n            .attr('x2', xScale.range()[1])\r\n            .attr('display', 'none');\r\n\r\n        lineV = root.append(\"line\")\r\n            .attr('class', 'crosshairs vertical')\r\n            .attr('y1', yScale.range()[0])\r\n            .attr('y2', yScale.range()[1])\r\n            .attr('display', 'none');\r\n\r\n        circle = root.append(\"circle\")\r\n            .attr('class', 'crosshairs circle')\r\n            .attr('r', 6)\r\n            .attr('display', 'none');\r\n\r\n        calloutH = root.append(\"text\")\r\n            .attr('class', 'crosshairs callout horizontal')\r\n            .attr('x', xScale.range()[1] - padding)\r\n            .attr('style', 'text-anchor: end')\r\n            .attr('display', 'none');\r\n\r\n        calloutV = root.append(\"text\")\r\n            .attr('class', 'crosshairs callout vertical')\r\n            .attr('y', '1em')\r\n            .attr('style', 'text-anchor: end')\r\n            .attr('display', 'none');\r\n    };\r\n\r\n    function mousemove() {\r\n\r\n        if (active) {\r\n            update();\r\n        }\r\n    }\r\n\r\n    function mouseout() {\r\n\r\n        if (active) {\r\n            clear();\r\n        }\r\n    }\r\n\r\n    function mouseclick() {\r\n\r\n        if (freezable) {\r\n            crosshairs.active(!active);\r\n        }\r\n    }\r\n\r\n    function findNearest(xTarget) {\r\n\r\n        var nearest = null,\r\n            dx = Number.MAX_VALUE;\r\n\r\n        series.forEach(function(data) {\r\n\r\n            var xDiff = Math.abs(xTarget.getTime() - data.date.getTime());\r\n\r\n            if (xDiff < dx) {\r\n                dx = xDiff;\r\n                nearest = data;\r\n            }\r\n        });\r\n\r\n        return nearest;\r\n    }\r\n\r\n    function findField(yTarget, data) {\r\n\r\n        var field = null;\r\n\r\n        var minDiff = Number.MAX_VALUE;\r\n        for (var property in data) {\r\n\r\n            if (!data.hasOwnProperty(property) || (property === 'date')) {\r\n                continue;\r\n            }\r\n\r\n            var dy = Math.abs(yTarget - data[property]);\r\n            if (dy <= minDiff) {\r\n                minDiff = dy;\r\n                field = property;\r\n            }\r\n        }\r\n\r\n        return field;\r\n    }\r\n\r\n    function update() {\r\n\r\n        var mouse = d3.mouse(target[0][0]),\r\n            xMouse = xScale.invert(mouse[0]),\r\n            yMouse = yScale.invert(mouse[1]),\r\n            nearest = findNearest(xMouse);\r\n\r\n        if (nearest !== null) {\r\n\r\n            var field = null;\r\n            if (nearest[yValue]) {\r\n                field = yValue;\r\n            } else {\r\n                field = findField(yMouse, nearest);\r\n            }\r\n\r\n            if ((nearest !== highlight) || (field !== highlightedField)) {\r\n\r\n                highlight = nearest;\r\n                highlightedField = field;\r\n\r\n                var x = xScale(highlight.date),\r\n                    y = yScale(highlight[highlightedField]);\r\n\r\n                lineH.attr('y1', y)\r\n                    .attr('y2', y);\r\n                lineV.attr('x1', x)\r\n                    .attr('x2', x);\r\n                circle.attr('cx', x)\r\n                    .attr('cy', y);\r\n                calloutH.attr('y', y - padding)\r\n                    .text(formatH(highlight[highlightedField], highlightedField));\r\n                calloutV.attr('x', x - padding)\r\n                    .text(formatV(highlight.date));\r\n\r\n                lineH.attr('display', 'inherit');\r\n                lineV.attr('display', 'inherit');\r\n                circle.attr('display', 'inherit');\r\n                calloutH.attr('display', 'inherit');\r\n                calloutV.attr('display', 'inherit');\r\n            }\r\n        }\r\n    }\r\n\r\n    function clear() {\r\n\r\n        highlight = null;\r\n        highlightedField = null;\r\n\r\n        lineH.attr('display', 'none');\r\n        lineV.attr('display', 'none');\r\n        circle.attr('display', 'none');\r\n        calloutH.attr('display', 'none');\r\n        calloutV.attr('display', 'none');\r\n    }\r\n\r\n    crosshairs.target = function (value) {\r\n        if (!arguments.length) {\r\n            return target;\r\n        }\r\n\r\n        if (target) {\r\n\r\n            target.on('mousemove.crosshairs', null);\r\n            target.on('mouseout.crosshairs', null);\r\n            target.on('click.crosshairs', null);\r\n        }\r\n\r\n        target = value;\r\n\r\n        target.on('mousemove.crosshairs', mousemove);\r\n        target.on('mouseout.crosshairs', mouseout);\r\n        target.on('click.crosshairs', mouseclick);\r\n\r\n        return crosshairs;\r\n    };\r\n\r\n    crosshairs.series = function (value) {\r\n        if (!arguments.length) {\r\n            return series;\r\n        }\r\n        series = value;\r\n        return crosshairs;\r\n    };\r\n\r\n    crosshairs.xScale = function (value) {\r\n        if (!arguments.length) {\r\n            return xScale;\r\n        }\r\n        xScale = value;\r\n        return crosshairs;\r\n    };\r\n\r\n    crosshairs.yScale = function (value) {\r\n        if (!arguments.length) {\r\n            return yScale;\r\n        }\r\n        yScale = value;\r\n        return crosshairs;\r\n    };\r\n\r\n    crosshairs.yValue = function (value) {\r\n        if (!arguments.length) {\r\n            return yValue;\r\n        }\r\n        yValue = value;\r\n        return crosshairs;\r\n    };\r\n\r\n    crosshairs.formatH = function (value) {\r\n        if (!arguments.length) {\r\n            return formatH;\r\n        }\r\n        formatH = value;\r\n        return crosshairs;\r\n    };\r\n\r\n    crosshairs.formatV = function (value) {\r\n        if (!arguments.length) {\r\n            return formatV;\r\n        }\r\n        formatV = value;\r\n        return crosshairs;\r\n    };\r\n\r\n    crosshairs.active = function (value) {\r\n        if (!arguments.length) {\r\n            return active;\r\n        }\r\n        active = value;\r\n\r\n        lineH.classed('frozen', !active);\r\n        lineV.classed('frozen', !active);\r\n        circle.classed('frozen', !active);\r\n\r\n        return crosshairs;\r\n    };\r\n\r\n    crosshairs.freezable = function (value) {\r\n        if (!arguments.length) {\r\n            return freezable;\r\n        }\r\n        freezable = value;\r\n        return crosshairs;\r\n    };\r\n\r\n    crosshairs.padding = function (value) {\r\n        if (!arguments.length) {\r\n            return padding;\r\n        }\r\n        padding = value;\r\n        return crosshairs;\r\n    };\r\n\r\n    crosshairs.highlightedField = function() {\r\n        return highlightedField;\r\n    };\r\n\r\n    return crosshairs;\r\n};\r\n\r\n}(d3, sl));","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    sl.tools.fibonacciFan = function () {\r\n\r\n        var target = null,\r\n            series = null,\r\n            xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear(),\r\n            active = true;\r\n\r\n        var circleOrigin = null,\r\n            circleTarget = null,\r\n            lineSource = null,\r\n            lineA = null,\r\n            lineB = null,\r\n            lineC = null,\r\n            fanArea = null;\r\n\r\n        var phase = 1,\r\n            locationOrigin = null,\r\n            locationTarget = null;\r\n\r\n        var fibonacciFan = function () {\r\n\r\n            var root = target.append('g')\r\n                .attr('class', 'fibonacci-fan');\r\n\r\n            circleOrigin = root.append(\"circle\")\r\n                .attr('class', 'fibonacci-fan origin')\r\n                .attr('r', 6)\r\n                .attr('display', 'none');\r\n\r\n            circleTarget = root.append(\"circle\")\r\n                .attr('class', 'fibonacci-fan target')\r\n                .attr('r', 6)\r\n                .attr('display', 'none');\r\n\r\n            lineSource = root.append(\"line\")\r\n                .attr('class', 'fibonacci-fan source')\r\n                .attr('display', 'none');\r\n\r\n            lineA = root.append(\"line\")\r\n                .attr('class', 'fibonacci-fan a')\r\n                .attr('display', 'none');\r\n\r\n            lineB = root.append(\"line\")\r\n                .attr('class', 'fibonacci-fan b')\r\n                .attr('display', 'none');\r\n\r\n            lineC = root.append(\"line\")\r\n                .attr('class', 'fibonacci-fan c')\r\n                .attr('display', 'none');\r\n\r\n            fanArea = root.append(\"polygon\")\r\n                .attr('class', 'fibonacci-fan area')\r\n                .attr('display', 'none');\r\n        };\r\n\r\n        function mousemove() {\r\n\r\n            if (!active) {\r\n                return;\r\n            }\r\n\r\n            switch (phase) {\r\n                case 1: {\r\n                    locationOrigin = findLocation();\r\n                    if (locationOrigin) {\r\n                        fibonacciFan.update();\r\n                        circleOrigin.attr('display', 'inherit');\r\n                    }\r\n                    break;\r\n                }\r\n                case 2: {\r\n                    locationTarget = findLocation();\r\n                    if (locationTarget) {\r\n                        fibonacciFan.update();\r\n                        circleTarget.attr('display', 'inherit');\r\n                        lineSource.attr('display', 'inherit');\r\n                    }\r\n                    break;\r\n                }\r\n                case 3: {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        function mouseclick() {\r\n\r\n            if (!active) {\r\n                return;\r\n            }\r\n\r\n            switch (phase) {\r\n                case 1: {\r\n\r\n                    phase = 2;\r\n                    break;\r\n                }\r\n                case 2: {\r\n\r\n                    setFan();\r\n\r\n                    phase = 3;\r\n                    break;\r\n                }\r\n                case 3: {\r\n\r\n                    clearAll();\r\n\r\n                    phase = 1;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        function findLocation() {\r\n\r\n            var mouse = d3.mouse(target[0][0]),\r\n                xMouse = xScale.invert(mouse[0]),\r\n                yMouse = yScale.invert(mouse[1]),\r\n                point = findPoint(xMouse);\r\n\r\n            if (point !== null) {\r\n\r\n                var field = findField(yMouse, point);\r\n\r\n                if (field !== null) {\r\n\r\n                    return { point: point, field: field }\r\n                }\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        function findPoint(xTarget) {\r\n\r\n            var nearest = null,\r\n                dx = Number.MAX_VALUE;\r\n\r\n            series.forEach(function(data) {\r\n\r\n                var xDiff = Math.abs(xTarget.getTime() - data.date.getTime());\r\n\r\n                if (xDiff < dx) {\r\n                    dx = xDiff;\r\n                    nearest = data;\r\n                }\r\n            });\r\n\r\n            return nearest;\r\n        }\r\n\r\n        function findField(yTarget, data) {\r\n\r\n            var field = null;\r\n\r\n            var minDiff = Number.MAX_VALUE;\r\n            for (var property in data) {\r\n\r\n                if (!data.hasOwnProperty(property) || (property === 'date')) {\r\n                    continue;\r\n                }\r\n\r\n                var dy = Math.abs(yTarget - data[property]);\r\n                if (dy <= minDiff) {\r\n                    minDiff = dy;\r\n                    field = property;\r\n                }\r\n            }\r\n\r\n            return field;\r\n        }\r\n\r\n        function setFan() {\r\n\r\n            if (xScale(locationOrigin.point.date) > xScale(locationTarget.point.date)) {\r\n                var tmp = locationOrigin;\r\n                locationOrigin = locationTarget;\r\n                locationTarget = tmp;\r\n            }\r\n\r\n            var originX = xScale(locationOrigin.point.date),\r\n                originY = yScale(locationOrigin.point[locationOrigin.field]),\r\n                targetX = xScale(locationTarget.point.date),\r\n                targetY = yScale(locationTarget.point[locationTarget.field]),\r\n                finalX = xScale.range()[1],\r\n                finalY = calculateY(originX, originY, targetX, targetY, finalX);\r\n\r\n            if (finalY) {\r\n\r\n                setFanLines(originX, originY, finalX, finalY.source, finalY.source, finalY.source);\r\n\r\n                lineA.attr('display', 'inherit');\r\n                lineB.attr('display', 'inherit');\r\n                lineC.attr('display', 'inherit');\r\n                fanArea.attr('display', 'inherit');\r\n\r\n                var pointsFinal = originX + ',' + originY\r\n                    + ' ' + finalX + ',' + finalY.a\r\n                    + ' ' + finalX + ',' + finalY.c;\r\n\r\n                lineA.transition()\r\n                    .attr('y2', finalY.a);\r\n                lineB.transition()\r\n                    .attr('y2', finalY.b);\r\n                lineC.transition()\r\n                    .attr('y2', finalY.c);\r\n                fanArea.transition()\r\n                    .attr('points', pointsFinal);\r\n            }\r\n\r\n            circleOrigin.attr('display', 'none');\r\n            circleTarget.attr('display', 'none');\r\n        }\r\n\r\n        function clearAll() {\r\n\r\n            locationOrigin = null;\r\n            locationTarget = null;\r\n\r\n            circleOrigin.attr('display', 'none');\r\n            circleTarget.attr('display', 'none');\r\n            lineSource.attr('display', 'none');\r\n            lineA.attr('display', 'none');\r\n            lineB.attr('display', 'none');\r\n            lineC.attr('display', 'none');\r\n            fanArea.attr('display', 'none');\r\n        }\r\n\r\n        function calculateY(originX, originY, targetX, targetY, finalX) {\r\n\r\n            if (originX === targetX) { return null; }\r\n\r\n            var gradient = (targetY - originY) / (targetX - originX),\r\n                ySource = (gradient * (finalX - originX)) + originY,\r\n                yA = ((gradient * 0.618) * (finalX - originX)) + originY,\r\n                yB = ((gradient * 0.500) * (finalX - originX)) + originY,\r\n                yC = ((gradient * 0.382) * (finalX - originX)) + originY;\r\n\r\n            return {source: ySource, a: yA, b: yB, c: yC};\r\n        }\r\n\r\n        function setFanLines(originX, originY, finalX, finalYa, finalYb, finalYc) {\r\n\r\n            var points = originX + ',' + originY\r\n                + ' ' + finalX + ',' + finalYa\r\n                + ' ' + finalX + ',' + finalYc;\r\n\r\n            lineA.attr('x1', originX)\r\n                .attr('y1', originY)\r\n                .attr('x2', finalX)\r\n                .attr('y2', finalYa);\r\n            lineB.attr('x1', originX)\r\n                .attr('y1', originY)\r\n                .attr('x2', finalX)\r\n                .attr('y2', finalYb);\r\n            lineC.attr('x1', originX)\r\n                .attr('y1', originY)\r\n                .attr('x2', finalX)\r\n                .attr('y2', finalYc);\r\n            fanArea.attr('points', points);\r\n        }\r\n\r\n        fibonacciFan.update = function () {\r\n\r\n            if (locationOrigin) {\r\n\r\n                var originX = xScale(locationOrigin.point.date),\r\n                    originY = yScale(locationOrigin.point[locationOrigin.field]);\r\n\r\n                circleOrigin.attr('cx', originX)\r\n                    .attr('cy', originY);\r\n                lineSource.attr('x1', originX)\r\n                    .attr('y1', originY);\r\n\r\n                if (locationTarget && (phase !== 1)) {\r\n\r\n                    var targetX = xScale(locationTarget.point.date),\r\n                        targetY = yScale(locationTarget.point[locationTarget.field]);\r\n\r\n                    circleTarget.attr('cx', targetX)\r\n                        .attr('cy', targetY);\r\n                    lineSource.attr('x2', targetX)\r\n                        .attr('y2', targetY);\r\n\r\n                    if (phase === 3) {\r\n\r\n                        var finalX = xScale.range()[1],\r\n                            finalY = calculateY(originX, originY, targetX, targetY, finalX);\r\n\r\n                        if (finalY) {\r\n                            setFanLines(originX, originY, finalX, finalY.a, finalY.b, finalY.c);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        fibonacciFan.visible = function (value) {\r\n\r\n            if (value) {\r\n\r\n                switch (phase) {\r\n                    case 1: {\r\n                        circleOrigin.attr('display', 'inherit');\r\n                        break;\r\n                    }\r\n                    case 2: {\r\n                        circleOrigin.attr('display', 'inherit');\r\n                        circleTarget.attr('display', 'inherit');\r\n                        lineSource.attr('display', 'inherit');\r\n                        break;\r\n                    }\r\n                    case 3: {\r\n                        lineSource.attr('display', 'inherit');\r\n                        lineA.attr('display', 'inherit');\r\n                        lineB.attr('display', 'inherit');\r\n                        lineC.attr('display', 'inherit');\r\n                        fanArea.attr('display', 'inherit');\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n\r\n                circleOrigin.attr('display', 'none');\r\n                circleTarget.attr('display', 'none');\r\n                lineSource.attr('display', 'none');\r\n                lineA.attr('display', 'none');\r\n                lineB.attr('display', 'none');\r\n                lineC.attr('display', 'none');\r\n                fanArea.attr('display', 'none');\r\n            }\r\n        };\r\n\r\n        fibonacciFan.target = function (value) {\r\n            if (!arguments.length) {\r\n                return target;\r\n            }\r\n\r\n            if (target) {\r\n\r\n                target.on('mousemove.fibonacci-fan', null);\r\n                target.on('click.fibonacci-fan', null);\r\n            }\r\n\r\n            target = value;\r\n\r\n            target.on('mousemove.fibonacci-fan', mousemove);\r\n            target.on('click.fibonacci-fan', mouseclick);\r\n\r\n            return fibonacciFan;\r\n        };\r\n\r\n        fibonacciFan.series = function (value) {\r\n            if (!arguments.length) {\r\n                return series;\r\n            }\r\n            series = value;\r\n            return fibonacciFan;\r\n        };\r\n\r\n        fibonacciFan.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return fibonacciFan;\r\n        };\r\n\r\n        fibonacciFan.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return fibonacciFan;\r\n        };\r\n\r\n        fibonacciFan.active = function (value) {\r\n            if (!arguments.length) {\r\n                return active;\r\n            }\r\n            active = value;\r\n            return fibonacciFan;\r\n        };\r\n\r\n        return fibonacciFan;\r\n    };\r\n\r\n}(d3, sl));","(function (d3, sl) {\r\n    'use strict';\r\n\r\n    sl.tools.measure = function () {\r\n\r\n        var target = null,\r\n            series = null,\r\n            xScale = d3.time.scale(),\r\n            yScale = d3.scale.linear(),\r\n            active = true,\r\n            padding = 2,\r\n            formatH = null,\r\n            formatV = null;\r\n\r\n        var circleOrigin = null,\r\n            circleTarget = null,\r\n            lineSource = null,\r\n            lineX = null,\r\n            lineY = null,\r\n            calloutX = null,\r\n            calloutY = null;\r\n\r\n        var phase = 1,\r\n            locationOrigin = null,\r\n            locationTarget = null;\r\n\r\n        var measure = function () {\r\n\r\n            var root = target.append('g')\r\n                .attr('class', 'measure');\r\n\r\n            circleOrigin = root.append(\"circle\")\r\n                .attr('class', 'measure origin')\r\n                .attr('r', 6)\r\n                .attr('display', 'none');\r\n\r\n            circleTarget = root.append(\"circle\")\r\n                .attr('class', 'measure target')\r\n                .attr('r', 6)\r\n                .attr('display', 'none');\r\n\r\n            lineSource = root.append(\"line\")\r\n                .attr('class', 'measure source')\r\n                .attr('display', 'none');\r\n\r\n            lineX = root.append(\"line\")\r\n                .attr('class', 'measure x')\r\n                .attr('display', 'none');\r\n\r\n            lineY = root.append(\"line\")\r\n                .attr('class', 'measure y')\r\n                .attr('display', 'none');\r\n\r\n            calloutX = root.append(\"text\")\r\n                .attr('class', 'measure callout horizontal')\r\n                .attr('style', 'text-anchor: end')\r\n                .attr('display', 'none');\r\n\r\n            calloutY = root.append(\"text\")\r\n                .attr('class', 'measure callout vertical')\r\n                .attr('style', 'text-anchor: middle')\r\n                .attr('display', 'none');\r\n        };\r\n\r\n        function mousemove() {\r\n\r\n            if (!active) {\r\n                return;\r\n            }\r\n\r\n            switch (phase) {\r\n                case 1: {\r\n                    locationOrigin = findLocation();\r\n                    if (locationOrigin) {\r\n                        measure.update();\r\n                        circleOrigin.attr('display', 'inherit');\r\n                    }\r\n                    break;\r\n                }\r\n                case 2: {\r\n                    locationTarget = findLocation();\r\n                    if (locationTarget) {\r\n                        measure.update();\r\n                        circleTarget.attr('display', 'inherit');\r\n                        lineSource.attr('display', 'inherit');\r\n                    }\r\n                    break;\r\n                }\r\n                case 3: {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        function mouseclick() {\r\n\r\n            if (!active) {\r\n                return;\r\n            }\r\n\r\n            switch (phase) {\r\n                case 1: {\r\n\r\n                    phase = 2;\r\n                    break;\r\n                }\r\n                case 2: {\r\n\r\n                    doMeasure();\r\n\r\n                    phase = 3;\r\n                    break;\r\n                }\r\n                case 3: {\r\n\r\n                    clearAll();\r\n\r\n                    phase = 1;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        function findLocation() {\r\n\r\n            var mouse = d3.mouse(target[0][0]),\r\n                xMouse = xScale.invert(mouse[0]),\r\n                yMouse = yScale.invert(mouse[1]),\r\n                point = findPoint(xMouse);\r\n\r\n            if (point !== null) {\r\n\r\n                var field = findField(yMouse, point);\r\n\r\n                if (field !== null) {\r\n\r\n                    return { point: point, field: field }\r\n                }\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        function findPoint(xTarget) {\r\n\r\n            var nearest = null,\r\n                dx = Number.MAX_VALUE;\r\n\r\n            series.forEach(function(data) {\r\n\r\n                var xDiff = Math.abs(xTarget.getTime() - data.date.getTime());\r\n\r\n                if (xDiff < dx) {\r\n                    dx = xDiff;\r\n                    nearest = data;\r\n                }\r\n            });\r\n\r\n            return nearest;\r\n        }\r\n\r\n        function findField(yTarget, data) {\r\n\r\n            var field = null;\r\n\r\n            var minDiff = Number.MAX_VALUE;\r\n            for (var property in data) {\r\n\r\n                if (!data.hasOwnProperty(property) || (property === 'date')) {\r\n                    continue;\r\n                }\r\n\r\n                var dy = Math.abs(yTarget - data[property]);\r\n                if (dy <= minDiff) {\r\n                    minDiff = dy;\r\n                    field = property;\r\n                }\r\n            }\r\n\r\n            return field;\r\n        }\r\n\r\n        function doMeasure() {\r\n\r\n            var originX = xScale(locationOrigin.point.date),\r\n                originY = yScale(locationOrigin.point[locationOrigin.field]),\r\n                targetX = xScale(locationTarget.point.date),\r\n                targetY = yScale(locationTarget.point[locationTarget.field]);\r\n\r\n            lineX.attr('x1', originX)\r\n                .attr('y1', originY)\r\n                .attr('x2', targetX)\r\n                .attr('y2', originY);\r\n            lineY.attr('x1', targetX)\r\n                .attr('y1', originY)\r\n                .attr('x2', targetX)\r\n                .attr('y2', targetY);\r\n\r\n            calloutX.attr('x', targetX - padding)\r\n                .attr('y', originY - (originY - targetY) / 2.0)\r\n                .text(formatV(Math.abs(locationTarget.point[locationTarget.field] - locationOrigin.point[locationOrigin.field])));\r\n            calloutY.attr('y', originY - padding)\r\n                .attr('x', originX + (targetX - originX) / 2.0)\r\n                .text(formatH(Math.abs(locationTarget.point.date.getTime() - locationOrigin.point.date.getTime())));\r\n\r\n            lineX.attr('display', 'inherit');\r\n            lineY.attr('display', 'inherit');\r\n            calloutX.attr('display', 'inherit');\r\n            calloutY.attr('display', 'inherit');\r\n\r\n            circleOrigin.attr('display', 'none');\r\n            circleTarget.attr('display', 'none');\r\n        }\r\n\r\n        function clearAll() {\r\n\r\n            locationOrigin = null;\r\n            locationTarget = null;\r\n\r\n            circleOrigin.attr('display', 'none');\r\n            circleTarget.attr('display', 'none');\r\n            lineSource.attr('display', 'none');\r\n            lineX.attr('display', 'none');\r\n            lineY.attr('display', 'none');\r\n            calloutX.attr('display', 'none');\r\n            calloutY.attr('display', 'none');\r\n        }\r\n\r\n        measure.update = function () {\r\n\r\n            if (locationOrigin) {\r\n\r\n                var originX = xScale(locationOrigin.point.date),\r\n                    originY = yScale(locationOrigin.point[locationOrigin.field]);\r\n\r\n                circleOrigin.attr('cx', originX)\r\n                    .attr('cy', originY);\r\n                lineSource.attr('x1', originX)\r\n                    .attr('y1', originY);\r\n\r\n                if (locationTarget && (phase !== 1)) {\r\n\r\n                    var targetX = xScale(locationTarget.point.date),\r\n                        targetY = yScale(locationTarget.point[locationTarget.field]);\r\n\r\n                    circleTarget.attr('cx', targetX)\r\n                        .attr('cy', targetY);\r\n                    lineSource.attr('x2', targetX)\r\n                        .attr('y2', targetY);\r\n\r\n                    if (phase === 3) {\r\n\r\n                        doMeasure();\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        measure.visible = function (value) {\r\n\r\n            if (value) {\r\n\r\n                switch (phase) {\r\n                    case 1: {\r\n                        circleOrigin.attr('display', 'inherit');\r\n                        break;\r\n                    }\r\n                    case 2: {\r\n                        circleOrigin.attr('display', 'inherit');\r\n                        circleTarget.attr('display', 'inherit');\r\n                        lineSource.attr('display', 'inherit');\r\n                        break;\r\n                    }\r\n                    case 3: {\r\n                        lineSource.attr('display', 'inherit');\r\n                        lineX.attr('display', 'inherit');\r\n                        lineY.attr('display', 'inherit');\r\n                        calloutX.attr('display', 'inherit');\r\n                        calloutY.attr('display', 'inherit');\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n\r\n                circleOrigin.attr('display', 'none');\r\n                circleTarget.attr('display', 'none');\r\n                lineSource.attr('display', 'none');\r\n                lineX.attr('display', 'none');\r\n                lineY.attr('display', 'none');\r\n                calloutX.attr('display', 'none');\r\n                calloutY.attr('display', 'none');\r\n            }\r\n        };\r\n\r\n        measure.target = function (value) {\r\n            if (!arguments.length) {\r\n                return target;\r\n            }\r\n\r\n            if (target) {\r\n\r\n                target.on('mousemove.measure', null);\r\n                target.on('click.measure', null);\r\n            }\r\n\r\n            target = value;\r\n\r\n            target.on('mousemove.measure', mousemove);\r\n            target.on('click.measure', mouseclick);\r\n\r\n            return measure;\r\n        };\r\n\r\n        measure.series = function (value) {\r\n            if (!arguments.length) {\r\n                return series;\r\n            }\r\n            series = value;\r\n            return measure;\r\n        };\r\n\r\n        measure.xScale = function (value) {\r\n            if (!arguments.length) {\r\n                return xScale;\r\n            }\r\n            xScale = value;\r\n            return measure;\r\n        };\r\n\r\n        measure.yScale = function (value) {\r\n            if (!arguments.length) {\r\n                return yScale;\r\n            }\r\n            yScale = value;\r\n            return measure;\r\n        };\r\n\r\n        measure.active = function (value) {\r\n            if (!arguments.length) {\r\n                return active;\r\n            }\r\n            active = value;\r\n            return measure;\r\n        };\r\n\r\n        measure.padding = function (value) {\r\n            if (!arguments.length) {\r\n                return padding;\r\n            }\r\n            padding = value;\r\n            return measure;\r\n        };\r\n\r\n        measure.formatH = function (value) {\r\n            if (!arguments.length) {\r\n                return formatH;\r\n            }\r\n            formatH = value;\r\n            return measure;\r\n        };\r\n\r\n        measure.formatV = function (value) {\r\n            if (!arguments.length) {\r\n                return formatV;\r\n            }\r\n            formatV = value;\r\n            return measure;\r\n        };\r\n\r\n        return measure;\r\n    };\r\n\r\n}(d3, sl));","(function (sl, moment, jStat) {\r\n    'use strict';\r\n\r\n    sl.utilities.dataGenerator = function () {\r\n\r\n        var mu = 0.1,\r\n            sigma = 0.1,\r\n            startingPrice = 100,\r\n            startingVolume = 100000,\r\n            intraDaySteps = 50,\r\n            volumeNoiseFactor = 0.3,\r\n            toDate = new Date(),\r\n            fromDate = new Date(),\r\n            filter = function (moment) {\r\n                return !(moment.day() === 0 || moment.day() === 6);\r\n            };\r\n\r\n        var generatePrices = function (period, steps) {\r\n            var increments = generateIncrements(period, steps, mu, sigma),\r\n                i, prices = [];\r\n            prices[0] = startingPrice;\r\n\r\n            for (i = 1; i < increments.length; i += 1) {\r\n                prices[i] = prices[i - 1] * increments[i];\r\n            }\r\n            return prices;\r\n        };\r\n\r\n        var generateVolumes = function (period, steps) {\r\n            var increments = generateIncrements(period, steps, 0, 1),\r\n                i, volumes = [];\r\n\r\n            volumeNoiseFactor = Math.max(0, Math.min(volumeNoiseFactor, 1));\r\n            volumes[0] = startingVolume;\r\n\r\n            for (i = 1; i < increments.length; i += 1) {\r\n                volumes[i] = volumes[i - 1] * increments[i];\r\n            }\r\n            volumes = volumes.map(function (vol) {\r\n                return Math.floor(vol * (1 - volumeNoiseFactor + Math.random() * volumeNoiseFactor * 2));\r\n            });\r\n            return volumes;\r\n        };\r\n\r\n        var generateIncrements = function (period, steps, mu, sigma) {\r\n            // Geometric Brownian motion model.\r\n            var deltaY = period / steps,\r\n                sqrtDeltaY = Math.sqrt(deltaY),\r\n                deltaW = jStat().randn(1, steps).multiply(sqrtDeltaY),\r\n                increments =  deltaW\r\n                    .multiply(sigma)\r\n                    .add((mu - ((sigma * sigma) / 2)) * deltaY),\r\n                expIncrements = increments.map(function (x) {\r\n                    return Math.exp(x);\r\n                });\r\n\r\n            return jStat.row(expIncrements, 0);\r\n        };\r\n\r\n        var generate = function() {\r\n\r\n            var range = moment().range(fromDate, toDate),\r\n                msec_per_year = 3.15569e10,\r\n                rangeYears = range / msec_per_year,\r\n                daysIncluded = 0,\r\n                prices,\r\n                volume,\r\n                ohlcv = [],\r\n                daySteps,\r\n                currentStep = 0,\r\n                currentIntraStep = 0;\r\n\r\n            range.by('days', function (moment) {\r\n                if (!filter || filter(moment)) {\r\n                    daysIncluded += 1;\r\n                }\r\n            });\r\n\r\n            prices = generatePrices(rangeYears, daysIncluded * intraDaySteps);\r\n            volume = generateVolumes(rangeYears, daysIncluded);\r\n\r\n            range.by('days', function (moment) {\r\n                if (!filter || filter(moment)) {\r\n                    daySteps = prices.slice(currentIntraStep, currentIntraStep + intraDaySteps);\r\n                    ohlcv.push({\r\n                        date: moment.toDate(),\r\n                        open: daySteps[0],\r\n                        high: Math.max.apply({}, daySteps),\r\n                        low: Math.min.apply({}, daySteps),\r\n                        close: daySteps[intraDaySteps - 1],\r\n                        volume: volume[currentStep]\r\n                    });\r\n                    currentIntraStep += intraDaySteps;\r\n                    currentStep += 1\r\n                }\r\n            });\r\n\r\n            return ohlcv;\r\n        };\r\n\r\n        var dataGenerator = function (selection) {\r\n        };\r\n\r\n        dataGenerator.generate = function() {\r\n            return generate();\r\n        };\r\n\r\n        dataGenerator.mu = function (value) {\r\n            if (!arguments.length) {\r\n                return mu;\r\n            }\r\n            mu = value;\r\n            return dataGenerator;\r\n        };\r\n\r\n        dataGenerator.sigma = function (value) {\r\n            if (!arguments.length) {\r\n                return sigma;\r\n            }\r\n            sigma = value;\r\n            return dataGenerator;\r\n        };\r\n\r\n        dataGenerator.startingPrice = function (value) {\r\n            if (!arguments.length) {\r\n                return startingPrice;\r\n            }\r\n            startingPrice = value;\r\n            return dataGenerator;\r\n        };\r\n\r\n        dataGenerator.startingVolume = function (value) {\r\n            if (!arguments.length) {\r\n                return startingVolume;\r\n            }\r\n            startingVolume = value;\r\n            return dataGenerator;\r\n        };\r\n\r\n        dataGenerator.intraDaySteps = function (value) {\r\n            if (!arguments.length) {\r\n                return intraDaySteps;\r\n            }\r\n            intraDaySteps = value;\r\n            return dataGenerator;\r\n        };\r\n\r\n        dataGenerator.volumeNoiseFactor = function (value) {\r\n            if (!arguments.length) {\r\n                return volumeNoiseFactor;\r\n            }\r\n            volumeNoiseFactor = value;\r\n            return dataGenerator;\r\n        };\r\n\r\n        dataGenerator.filter = function (value) {\r\n            if (!arguments.length) {\r\n                return filter;\r\n            }\r\n            filter = value;\r\n            return dataGenerator;\r\n        };\r\n\r\n        dataGenerator.toDate = function (value) {\r\n            if (!arguments.length) {\r\n                return toDate;\r\n            }\r\n            toDate = value;\r\n            return dataGenerator;\r\n        };\r\n\r\n        dataGenerator.fromDate = function (value) {\r\n            if (!arguments.length) {\r\n                return fromDate;\r\n            }\r\n            fromDate = value;\r\n            return dataGenerator;\r\n        };\r\n\r\n        return dataGenerator;\r\n    };\r\n}(sl, moment, jStat));","(function (d3, sl, $) {\r\n    'use strict';\r\n\r\n    sl.utilities.dimensions = function () {\r\n\r\n        // Default values\r\n        var margin = {top: 20, right: 20, bottom: 20, left: 20},\r\n            width = 0,\r\n            height = 0;\r\n\r\n        var defaultWidth = true,\r\n            defaultHeight = true;\r\n\r\n        var dimensions = function (selection) {\r\n            selection.each( function () {\r\n                var element = d3.select(this);\r\n\r\n                // Attempt to automatically size the chart to the selected element\r\n                if (defaultWidth === true) {\r\n                    width = $(element[0]).width();\r\n                    if (dimensions.innerWidth() < 1) {\r\n                        width = 800 + margin.left + margin.right;\r\n                    }\r\n                }\r\n\r\n                if (defaultHeight === true) {\r\n                    height = $(element[0]).height();\r\n                    if (dimensions.innerHeight() < 1) {\r\n                        height = 400 + margin.top + margin.bottom;\r\n                    }\r\n                }\r\n\r\n                // Create svg\r\n                var svg = element.append('svg')\r\n                    .attr('width', width)\r\n                    .attr('height', height);\r\n\r\n                // Create group for the chart\r\n                var chart =  svg.append('g')\r\n                    .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\r\n\r\n                // Clipping path\r\n                chart.append('defs').append('clipPath')\r\n                    .attr('id', 'plotAreaClip')\r\n                    .append('rect')\r\n                    .attr({ width: dimensions.innerWidth(), height: dimensions.innerHeight() });\r\n\r\n                // Create plot area, using the clipping path\r\n                chart.append('g')\r\n                    .attr('clip-path', 'url(#plotAreaClip)')\r\n                    .attr('class', 'plotArea');\r\n            });\r\n        };\r\n\r\n        dimensions.marginTop = function (value) {\r\n            if (!arguments.length) {\r\n                return margin.top;\r\n            }\r\n            margin.top = value;\r\n            return dimensions;\r\n        };\r\n\r\n        dimensions.marginRight = function (value) {\r\n            if (!arguments.length) {\r\n                return margin.right;\r\n            }\r\n            margin.right = value;\r\n            return dimensions;\r\n        };\r\n\r\n        dimensions.marginBottom = function (value) {\r\n            if (!arguments.length) {\r\n                return margin.bottom;\r\n            }\r\n            margin.bottom = value;\r\n            return dimensions;\r\n        };\r\n\r\n        dimensions.marginLeft = function (value) {\r\n            if (!arguments.length) {\r\n                return margin.left;\r\n            }\r\n            margin.left = value;\r\n            return dimensions;\r\n        };\r\n\r\n        dimensions.width = function (value) {\r\n            if (!arguments.length) {\r\n                return width;\r\n            }\r\n            width = value;\r\n            defaultWidth = false;\r\n            return dimensions;\r\n        };\r\n\r\n        dimensions.height = function (value) {\r\n            if (!arguments.length) {\r\n                return height;\r\n            }\r\n            height = value;\r\n            defaultHeight = false;\r\n            return dimensions;\r\n        };\r\n\r\n        dimensions.innerWidth = function () {\r\n            var innerWidth = width - margin.left - margin.right;\r\n            return innerWidth;\r\n        };\r\n\r\n        dimensions.innerHeight = function () {\r\n            var innerHeight = height - margin.top - margin.bottom;\r\n            return innerHeight;\r\n        };\r\n\r\n        return dimensions;\r\n    };\r\n}(d3, sl, jQuery));"]}